title: C入坑指南--悬挂else
author: Qian Jipeng
tags:
  - else悬挂
categories:
  - C
date: 2019-10-09 20:39:00
---
# 写在前面(持续更新)
coding的过程中，经常会由于分之逻辑的处理不当，致使code产生错误的逻辑。在一次debug的过程中，我发现了自己的一个"bug"，if和else的处理不当。至于原因，想必大家都经历过，省略了该有的大括号。

# else悬挂问题
何为else悬挂？我们知道**else总是与他最接近的那个if相匹配**，但是我们写出的代码可能会有意想不到的效果。举个例子：</br>
```
// bad code
int main()
{
	int a = 0;
    int b = 1;
    if ( a > b )
    	if ( a > 0 )
        	printf("ok");
    else
    	printf("bad");
}
```
这是我们原本期望的程序，我们想要它输出`bad`，但是实际上，什么输出都没有！为什么？</br>
这里说一下Python语言，**强制缩进**，这时候我们可以不用写那烦人的大括号，但是C/C++/Java就不一样了，缩进对于他们没有作用，代码的分块是依赖于大括号的。</br>
上述代码中，我们期望else是与第一个if相匹配，事实上，它是与最靠近它的那个if(第二个if)匹配了，造成了if-else分支跳转的逻辑错误。可恨的是，***这种bug很难被发现！***为了找这个bug，我GDB单步运行一个个查看变量值才发现的。。。更可怕的是，自平时coding的过程中，还挺喜欢省略有的if、else后面的大括号！这算是给自己一个惊醒了。
```
// ok code
int main()
{
	int a = 0;
    int b = 1;
    if ( a > b ) {
    	if ( a > 0 ) {
        	printf("ok");
        }
    }
    else {
    	printf("bad");
    }
}
```
这样看上去虽然不如以上简介，但是保证逻辑的准确。所以说，还是老老实实把大括号带上吧！


